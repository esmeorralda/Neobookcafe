const SINGLE_CHAR_NORMALIZATION_MAP: Record<string, string> = {
    'ğ—Œ': 's', 'ğ˜´': 's', 'ğ™¨': 's', 'ğšœ': 's', 'ğ¬': 's', 'ğ‘ ': 's', 'ğ’”': 's', 'ğ“ˆ': 's', 'ğ”°': 's', 'ğ–˜': 's', 'ğ•¤': 's',
    'ï½“': 's', 'ÅŸ': 's', 'â“¢': 's', 'â’®': 's', 'ğŸ…¢': 's', 'ğŸ†‚': 's', 'ğŸ…‚': 's', 'ğ‘º': 's', 'Å¿': 's', '$': 's', '5': 's', // Å¿:s ìœ ì§€, Å¡, Å›, Å, á¹£, á¹¡, È™, á¹¥, á¹§, á¹©ëŠ” s ì„¹ì…˜ì—ë§Œ ìˆì—ˆìŒ

    'ğ–¾': 'e', 'ğ˜¦': 'e', 'ğ™š': 'e', 'ğš': 'e', 'ğ': 'e', 'ğ‘’': 'e', 'ğ’†': 'e', 'â„¯': 'e', 'ğ“®': 'e', 'ğ”¢': 'e', 'ğ–Š': 'e', 'ğ•–': 'e',
    'ï½…': 'e', 'Ä—': 'e', 'â“”': 'e', 'â’ ': 'e', 'ğŸ…”': 'e', 'ğŸ…´': 'e', 'ğŸ„´': 'e', 'Ñ”': 'e', 'Ãª': 'e', 'Ã«': 'e', 'Ã©': 'e', 'Ã¨': 'e',
    'Ä“': 'e', 'Ä•': 'e', 'Ä›': 'e', 'Ä™': 'e', 'áº¹': 'e', 'áº»': 'e', 'áº½': 'e', 'áº¿': 'e', 'á»': 'e', 'á»‡': 'e', 'á»…': 'e', 'á»ƒ': 'e',
    '3': 'e', 'â‚¬': 'e',

    'ğ—‘': 'x', 'ğ˜¹': 'x', 'ğ™­': 'x', 'ğš¡': 'x', 'ğ±': 'x', 'ğ‘¥': 'x', 'ğ’™': 'x', 'ğ“': 'x', 'ğ”': 'x', 'ğ”µ': 'x', 'ğ–': 'x', 'ğ•©': 'x',
    'ï½˜': 'x', 'â“§': 'x', 'â’³': 'x', 'ğŸ…§': 'x', 'ğŸ†‡': 'x', 'ğŸ…‡': 'x', 'Ã—': 'x', 'âœ•': 'x', 'âœ–': 'x', 'âŒ': 'x', 'â¨¯': 'x',
    'âš”': 'x', '*': 'x', 'âœ—': 'x', 'âœ˜': 'x',

    'Å³': 'u', 'Ã¼': 'u', 'Ãº': 'u', 'Ã¹': 'u', 'Ã»': 'u', 'Å©': 'u', 'Å«': 'u', 'Å­': 'u', 'Å¯': 'u', 'Å±': 'u', 'á»¥': 'u', 'Æ°': 'u',
    'Ã§': 'c', 'Ä‡': 'c', 'Ä‰': 'c', 'Ä': 'c', 'Ä‹': 'c', 'Â¢': 'c', 'Â©': 'c', 'á¸‰': 'c', '(': 'c', '<': 'c',
    'ï¼¦': 'F', 'á¸': 'F', 'Æ‘': 'F', 'â„±': 'F', 'ê˜': 'F', 'ê»': 'F',
    'ï¼«': 'K', 'á¸°': 'K', 'Ç¨': 'K', 'á¸²': 'K', 'á¸´': 'K', 'â±©': 'K', 'ê€': 'K',
    'ï¼£': 'C', 'Ä†': 'C', 'Äˆ': 'C', 'ÄŒ': 'C', 'ÄŠ': 'C', 'Ã‡': 'C', 'á¸ˆ': 'C',
    'ï¼µ': 'U', 'Ãš': 'U', 'Ã™': 'U', 'Ã›': 'U', 'Å¨': 'U', 'Åª': 'U', 'Å¬': 'U', 'Å®': 'U', 'Å°': 'U', 'á»¤': 'U',

    'ã…—': 'ã…—', 'â”»': 'ã…—', 'â”´': 'ã…—', 'â”¹': 'ã…—', 'âŠ¥': 'ã…—', 'â€ ': 'ã…—', 'âŸ‚': 'ã…—', 'â•¨': 'ã…—', 'â•§': 'ã…—', 'â•¥': 'ã…—',
    '^': 'ã……', 'äºº': 'ã……', 'âˆ§': 'ã……', 'ã‰¦': 'ã……', 'á²': 'ã……', 'Î›': 'ã……', 'â©˜': 'ã……', 'â‹€': 'ã……', 'â©š': 'ã……',
    'ç”˜': 'ã…‚', 'å»¿': 'ã…‚', 'á—¨': 'ã…‚', 'á—': 'ã…‚', 'á—•': 'ã…‚', 'ç”°': 'ã…‚', 'å£': 'ã…‚', 'æ—¥': 'ã…‚', 'ç›®': 'ã…‚', 'å›—': 'ã…‚',
    'å·±': 'ã„¹', 'ä¹™': 'ã„¹', 'å·²': 'ã„¹', 'å·³': 'ã„¹', 'åŒš': 'ã„·',
    'åœ': 'ã…', '/': 'ã…', 'â¼ƒ': 'ã…', 'â¼': 'ã…', 'â¼‚': 'ã…', 'r': 'ã…', 'F': 'ã…',
    'ã…£': 'ã…£', 'Â¦': 'ã…£', 'ï½œ': 'ã…£', 'ï¿¤': 'ã…£', 'Ğ†': 'ã…£', 'Ó€': 'ã…£', '1': 'ã…£', '|': 'ã…£', 'l': 'ã…£', '!': 'ã…£', 'I': 'ã…£', // 1, |, l, !, I ëª¨ë‘ ã…£ë¡œ ë§¤í•‘
    'H': 'ã…', 'ã…–': 'ã…', 'ã…’': 'ã…', 'Ğ': 'ã…', 'â²': 'ã…', 'â„': 'ã…',
    'ğŸ¦': 'ìƒˆ', 'ğŸ”': 'ìƒˆ', 'ğŸ¦…': 'ìƒˆ', 'ğŸ¦‰': 'ìƒˆ', 'ğŸ¦†': 'ìƒˆ', 'ğŸ¦œ': 'ìƒˆ', 'ğŸ¦¤': 'ìƒˆ', 'ğŸ¦¢': 'ìƒˆ', 'ğŸ•Š': 'ìƒˆ',
    'ğŸ•': 'ê°œ', 'ğŸ¶': 'ê°œ', 'ğŸº': 'ê°œ',
    'ä¸•': 'ì¡°', 'æœ': 'ì¡°', 'å‰‡': 'ì¡°', 'å…†': 'ì¡°', 'çµ„': 'ì¡°', 'æ—©': 'ì¡°', 'é³¥': 'ì¡°', 'æ½®': 'ì¡°', 'ç…§': 'ì¡°',
    '0': 'ã…‡', 'O': 'ã…‡', 'o': 'ã…‡', 'â—¯': 'ã…‡', 'â­•': 'ã…‡', 'â—‹': 'ã…‡', 'â—': 'ã…‡', 'â—': 'ã…‡', 'â—‰': 'ã…‡', 'â—Œ': 'ã…‡', // o:ã…‡ ìœ ì§€

    'a': 'a', '@': 'a', '4': 'a', 'Î±': 'a', 'Ã¤': 'a', 'Ã¥': 'a', 'Ã£': 'a', 'Ä': 'a', 'È§': 'a', 'Ç': 'a',
    'b': 'b', '8': 'b', '6': 'b', 'Æƒ': 'b', 'É“': 'b', 'Æ„': 'b', 'â„¬': 'b', 'á–¯': 'b', 'á‘²': 'b',
    'd': 'd', 'á¸‹': 'd', 'á¸': 'd', 'á‘¯': 'd', 'á—': 'd', 'á—ª': 'd', 'á–™': 'd', 'â…†': 'd', 'É—': 'd',
    'f': 'f', 'Æ’': 'f', 'á¸Ÿ': 'f', 'â…': 'f', 'á¶‚': 'f', 'êœ°': 'f', 'êŸ»': 'f',
    'g': 'g', 'Ç¥': 'g', 'É¡': 'g', 'Ä¡': 'g', 'Ä£': 'g', 'Ä': 'g', 'Ç§': 'g', '9': 'g', 
    'h': 'h', 'Ä¥': 'h', 'Ä§': 'h', 'Æ•': 'h', 'á¸¥': 'h', 'á¸«': 'á¸«', 'â±¨': 'h', 'êœ§': 'h',
    'i': 'i', 'Ä«': 'i', 'Ä­': 'i', 'Ç': 'i', 'Ä¯': 'i',
    'j': 'j', 'Äµ': 'j', 'Ç°': 'j', 'È·': 'j', 'É‰': 'j', 'â±¼': 'j', 'Ê': 'j', 'ÉŸ': 'j',
    'k': 'k', 'Ä·': 'k', 'Æ™': 'k', 'Ç©': 'k', 'á¸±': 'k', 'á¸³': 'k', 'á¸µ': 'k', 'â±ª': 'k',
    'Äº': 'l', 'Ä¼': 'l', 'Ä¾': 'l', 'Å€': 'l', 'Å‚': 'l',
    'm': 'm', 'É±': 'm', 'á¸¿': 'm', 'á¹': 'm', 'á¹ƒ': 'm', 'â±¥': 'm', 'áµ¯': 'm', 'á´': 'm',
    'n': 'n', 'Å„': 'n', 'Åˆ': 'n', 'Ã±': 'n', 'Å†': 'n', 'á¹…': 'n', 'á¹‡': 'n', 'á¹‰': 'n',
    'p': 'p', 'á¹•': 'p', 'á¹—': 'p', 'Æ¥': 'p', 'áµ½': 'p', 'áµ±': 'p', 'á´˜': 'p', 'á‘­': 'p',
    'q': 'q', 'Ê ': 'q', 'É‹': 'q', 'È¹': 'q', 'â±Š': 'q', 'â±': 'q', 'ê—': 'q',
    'Å•': 'r', 'Å™': 'r', 'Å—': 'r', 'á¹™': 'r', 'á¹›': 'r', 'á¹': 'r', 'á¹Ÿ': 'r', 
    't': 't', '7': 't', '+': 't', 'Å¥': 't', 'Å£': 't', 'Å§': 't', 'È›': 't', 'á¹«': 't',
    'v': 'v', 'á¹¿': 'v', 'â±´': 'v', 'áµ¥': 'v', 'áµ›': 'v', 'âˆš': 'v', 'á±': 'v', 'âˆ¨': 'v',
    'w': 'w', 'áº': 'w', 'áºƒ': 'w', 'áº…': 'w', 'Åµ': 'w', 'áº‡': 'w', 'áº‰': 'w', 'â±³': 'w',
    'y': 'y', 'Ã½': 'y', 'á»³': 'y', 'Å·': 'y', 'Ã¿': 'y', 'È³': 'y', 'áº': 'y', 'á»µ': 'y',
    'z': 'z', '2': 'z', 'Åº': 'z', 'áº‘': 'z', 'Å¾': 'z', 'Å¼': 'z', 'áº“': 'z', 'áº•': 'z',
};

const MULTI_CHAR_REPLACEMENTS: Record<string, string> = {
    '_ã…£_': 'ã…—', '_/_': 'ã…—', '_ |\_': 'ã…—', '_|\_': 'ã…—', '_ã…£\\_': 'ã…—', '_I_': 'ã…—',
    'ï¼ï¼¼': 'ã……', '/ï¼¼': 'ã……',
    '77': 'ã„²',
    'åˆ€åœ': 'ê¹Œ',
    'â‚¨': 'rs',
    'ã…‡l=ìŠ¤': 'ì„¹ìŠ¤',
    'ã…‡ã…£-ã…£': 'ì• ',
    'lã…£': 'ë‹ˆ',
    'ã…ã…£': 'ë¯¸',
    'ä¸•åˆ€åœå·±åœäººä¸¨å»¿åœå·±åœå£åœ': 'ì¡°ê¹Œì”¹ìŒ”ë¼',
};

const FALSE_POSITIVE_PATTERNS_GENERAL: string[] = [
    'ã…—ë¨¹ì–´', 'ì˜¤ã…—', 'í•´ã…—', 'í˜¸ã…—', 'ë¡œã…—', 'ì˜¹ã…—', 'ë¡¤ã…—', 'ìš”ã…—', 'ìš°ã…—', 'í•˜ã…—',
    'ã…—ì˜¤', 'ã…—í˜¸', 'ã…—ë¡œ', 'ã…—ì˜¹', 'ã…—ë¡¤', 'ã…—ìš”', 'ã…—ìš°', 'ã…—í•˜',
    'ã…—ã…—ì˜¤', 'ã…—ã…—í˜¸', 'ã…—ã…—ë¡œ', 'ã…—ã…—ì˜¹', 'ã…—ã…—ë¡¤', 'ã…—ã…—ìš”', 'ã…—ã…—ìš°', 'ã…—ã…—í•˜',
    'ì˜¤ã…—ã…—ã…—', 'í˜¸ã…—ã…—ã…—', 'ë¡œã…—ã…—ã…—', 'ì˜¹ã…—ã…—ã…—', 'ë¡¤ã…—ã…—ã…—', 'ìš”ã…—ã…—ã…—', 'ìš°ã…—ã…—ã…—', 'í•˜ã…—ã…—ã…—',
    'ì˜¤ã…—ã…—ã…—ã…—', 'í˜¸ã…—ã…—ã…—ã…—', 'ë¡œã…—ã…—ã…—ã…—', 'ì˜¹ã…—ã…—ã…—ã…—', 'ë¡¤ã…—ã…—ã…—ã…—', 'ìš”ã…—ã…—ã…—ã…—', 'ìš°ã…—ã…—ã…—ã…—', 'í•˜ã…—ã…—ã…—ã…—',
    'ã…‡ã…—', 'ã…—ã„·', 'ã…—ã…œ', 'rã…—', 'ã…—r', 'sã…—', 'ã…—s', 'eã…—', 'ã…—e', 'fã…—', 'ã…—f', 'aã…—', 'ã…—a',
    'qã…—', 'ã…—q', 'ã…—w', 'wã…—', 'ã…—d', 'dã…—', 'ã…—g', 'gã…—',
    '118', '218', '318', '418', '518', '618', '718', '818', '918', '018',
    '8ë¶„', '8ì‹œ', '8ì‹œë°œ',
    'ë°œë‹¦', 'ë™ì‹œ8', 'ë‹¤ì‹œë°©', 'ì‹œë¶ˆì´ìµ', 'ë‹¤ì‹œë°”ê¿€', 'ë‹¤ì‹œë°”ê¿”', 'ë‹¤ì‹œë¶ˆëŸ¬', 'ë‹¤ì‹œë¶ˆì•ˆ',
    'í•˜ì‹œë°”ë¼ì´ë…¸ìŠ¤ì¼€', 'í• ì‹œ', 'ì‹œë°œìŒ', 'ì‹œë°œíƒì‹œ', 'ì‹œë°œìë™ì°¨', 'ì •ì¹˜ë°œ', 'ì‹œë°œì ', 'ì‹œë°œìœ ',
    'ì‹œë°œì—­', 'ì‹œë°œìˆ˜ë¢°', 'ì•„ì €ì”¨ë°”', 'ì•„ì €ì”¨ë°œ', 'ì‹œë°”ê²¬', 'ë²Œì–´', 'ì‹œë°”ì´ëˆ„', 'ì‹œë°”ìŠ¤ë¦¬ê°ˆ',
    'ì‹œë°”ì‚°', 'ì‹œë°”ì‹ ', 'ì˜¤ë¦¬ë°œ', 'ë°œë', 'ë‹¤ì‹œë°”', 'ë‹¤ì‹œíŒ”', 'ë¹„ìŠˆëˆ„ì‹œë°”', 'ì‹œë°”í•«ì¹´ì´',
    'ì‹œë°”íƒ€ì´ì¥¬', 'ë°ìŠ¤í‹°ë‹ˆì‹œë°”', 'ì‹œë°”ë£¨', 'ì‹œë°”ë£Œíƒ€ë¡œ', 'ì‹œë°”ë¼ìŠ¤ì‹œ', 'ì„ì‹œë°©í¸', 'ì ¤ë¦¬',
    'ë°œì‚¬', 'í¬ì‹œì•¼', 'í¬ì‹œ', 'ì–´ì°Œ', 'ê°€ì‹œë°©ì„', 'ë°œë¡œë€íŠ¸ë°©', 'ë°œë¡œë€íŠ¸', 'ë°œë¡œ', 'ì”¨ë°œë¼',
    'ë¬´ì‹œë°œì–¸', 'ì¼ì‹œë¶ˆ', 'ìš°ë¦¬', 'í˜¹ì‹œ', 'ì•„ì¡°ì”¨', 'ì•„ì €ì”¨', 'ë°”ë¡œ', 'ì €ê±°ì‹œ', 'ìš°ë¦¬ë°œ',
    'í”¼ì‹œë°©', 'í”¼ì”¨ë°©', 'ë°©ì¥', 'ì‹œë°”ì‚¬í‚¤', 'ì‹œë°œì°¨', 'êµ¬ë¡œì—­ì‹œë°œ', 'ë¡œë²…ìŠ¤', 'ì‰¬ë°”ë‚˜', 'ë²Œì—ˆëŠ”ë°',
    'ì— ì”¨ë°©', 'ë¹¨ë¦¬', 'íŒŒì— ', 'ë²Œê¸ˆ', 'ì‹œë°©í–¥', 'ë¶ˆë²•', 'ë°œë¦´', 'ë°œí‘œ', 'ë°©ì†¡', 'ì—­ì‹œ', 'ë°”ë³´',
    'ì¿¨ë¦¬ë°œë¦¬', 'ìŠˆë°œë¦¬ì—', 'ë°©íƒ„', 'ë°©ì–´', 'ë°œí‘œ', 'ìƒì‹œ',
    'opgg',
    'ìˆì§€', 'ì—†ì§€', 'í•˜ì§€', 'ì•Œì•˜ì§€', 'ëª°ëì§€', 'ê·¼ë°', 'ì§€ê·¼ê±°', 'ì§€ê·¼í•˜', 'ì§€ê·¼ì§€ê·¼', 'ì§€ê·¼ì†ê·¼',
    'ì†ë“ ì§€ê·¼', 'ë¯¸ì§€ê·¼', 'ì§€ë„íƒ„', 'ì§€ë„ë²„ë¦‡',
    '0ë“±ì‹ ', '1ë“±ì‹ ', '2ë“±ì‹ ', '3ë“±ì‹ ', '4ë“±ì‹ ', '5ë“±ì‹ ', '6ë“±ì‹ ', '7ë“±ì‹ ', '8ë“±ì‹ ', '9ë“±ì‹ ',
    'ë¶•ìš°ìœ ì‹ ',
    'ì „ì—¼ë³‘', 'ê°ì—¼ë³‘', 'í™”ì—¼ë³‘',
    'ì™œêº¼ì ¸', 'êº¼ì ¸ìš”', 'ì´êº¼ì ¸', 'êº¼ì ¸ì„œ', 'ë‚´êº¼ì ¸', 'ì œêº¼ì ¸', 'êº¼ì ¸ìˆ', 'êº¼ì ¸ì‡', 'êº¼ì ¸ë„',
    'ê³„ì†êº¼ì ¸', 'êº¼ì ¸ê°€',
    'ìƒˆë¡œ', 'ì˜ìƒˆë¼', 'ë£¨ì„¸ë¼', 'ì‹œì„¸ë¼', 'ì„¸ë¼ë¨¹', 'ê³ ì–‘ì´ìƒˆë¼', 'í˜¸ë‘ì´ìƒˆë¼', 'ìš©ìƒˆë¼', 'ë§ìƒˆë¼',
    'ì‚¬ììƒˆë¼', 'ë²”ìƒˆë¼', 'ì‚µìƒˆë¼', 'í‚¤ë³´ë“œ', 'ìƒˆë¼ì†', 'ì…°ë¦¬í”„', 'ë¡œì‰ë¦¬',
    '0ê°œ', '1ê°œ', '2ê°œ', '3ê°œ', '4ê°œ', '5ê°œ', '6ê°œ', '7ê°œ', '8ê°œ', '9ê°œ',
    '1ë…„', '2ë…„', '3ë…„', '4ë…„', '5ë…„', '6ë…„', '7ë…„', '8ë…„', '9ë…„',
    'ì¬ë°Œê²Œë†ˆ', 'ìˆê²Œ', 'ë…„ìƒ', 'ë¬´ì§€ê°œìƒ‰', 'ë– ëŒì´ê°œ', 'ì—ê²Œ', 'ë„˜ëŠ”', 'ì†Œê°œ', 'ìƒê¸´ê²Œ', 'ë‚ ê°œê°™ë‹¤',
    'ì¤«ìŠµë‹ˆë‹¤', 'ì¤«ìŒ', 'ì¤«ì–ì•„', 'ì¤«ê² ì§€', 'ì«’ì•„', 'ì«’ëŠ”', 'ì«’ê¸°ë‹¤', 'ì«’ê¸°ë¼', 'ì«’ê¸°ë¡œ',
    'ì«’ê¸°ë¥¼', 'ì«’ê¸°ë©°', 'ì«’ê¸°ëŠ”', 'ì«’ê¸°ë‚˜', 'ì«’ê²¨', 'ì«’ê²»', 'ì«’ê²¼', 'ì«’ì•˜', 'ì«’ë‹¤', 'ì«’ê³ ',
    'ì¤«ëŠ”', 'ì¤«ì–´', 'ì¤¬ëŠ”', 'ì¤«êµ°', 'ì¤¬ë‹¤', 'ì¤¬ì–´', 'ì²œì¡°', 'ì«’ê¸°', 'í•´ì¤«ë”ë‹ˆ', 'ì¤«ë‹¤', 'ë‚´ì«’ì€',
    'ë‚´ì«’ë‹¤', 'ì¢‡ì•„', "ë‚ ê°œ",
    'ã…¡'
];
const allFalsePositivePatterns: string[] = [
    ...FALSE_POSITIVE_PATTERNS_GENERAL,
];
allFalsePositivePatterns.sort((a, b) => b.length - a.length);

const ALL_FP_REGEX: RegExp = new RegExp(allFalsePositivePatterns.map(escapeRegex).join('|'), 'gi');

const GENERAL_PROFANITY_PATTERNS: string[] = [
    'ã…—', 'ì”¨8', '18ì•„', '18ë†ˆ', 'tã…‚', 'të°œ', 'ã…†ã…', 'sibal', 'sival', 'sibar', 'sibak', 'sipal',
    'siqk', 'tlbal', 'tlval', 'tlbar', 'tlbak', 'tlpal', 'tlqk', 'ì‹œë°œ', 'ì‹œval', 'ì‹œbar',
    'ì‹œbak', 'ì‹œpal', 'ì‹œqk', 'sië°”', 'sië°œ', 'sië¶ˆ', 'sië¹¨', 'siíŒ”', 'tlë°”', 'tlë°œ', 'tlë¶ˆ', 'tlë¹¨', 'tlíŒ”',
    'siba', 'tlba', 'siva', 'tlva', 'tlqkf', '10ë°œë†ˆ', '10ë°œë…„', 'tlqkd', 'si8', '10rë†ˆ', 'ì‹œ8', 'ì‹­8',
    's1bal', 'sibì•Œ', 'ì”¨x', 'siã…‚', 'ä¸¨ë°œ', 'ä¸¨ë²Œ', 'ä¸¨ë°”', 'ã……1', 'ì‹œã…£', 'ì”¨ã…£', '8ì‹œë°œ',
    'ã…†ë°œ', 'ã……ë°œ', 'ã……ã…‚', 'ã…†ã…‚', 'ã…†ë°”', 'ã……ë°”', 'ì‹œã…‚ã…', 'ã……ã…‚ã…', 'ì‹œã…ã„¹', 'ì”¨ã…ã„¹',
    'ã……ë¶ˆ', 'ã…†ë¶ˆ', 'ã……ì ', 'ã…†ë¿”', 'ã…†ã…£ë°œ', 'ã……ã…Ÿë°œ', 'ã……ã…£ã…‚ã…', 'ã…£ë°”ì•Œ', 'ã……ë²Œ', '^^ã…£ë²Œ',
    'ã…†ì‚ë¼', 'ì”¨ã…ƒ', '^^/ë°œ', 'ì‹œë´˜', 'ì”¨ë´˜', 'ì”¨ë°”', 'ì‹œë°”', 'ìƒ¤ë°œ', 'ì”Œë°œ', 'ì”¹ë°œ', 'ì‹œë²Œ',
    'ì‹œíŒ”', 'ì‹¯íŒ”', 'ì”¨ë¹¨', 'ì”¨ë¼', 'ì”¨íŒŒ', 'ë ë°œ', 'ë¡ë°œ', 'ë¸ë°œ', 'ì‹¸ë°œ', 'ì‹­ë°œ', 'ìŠˆë°œ',
    'ì•¼ë°œ', 'ì”¨ë¶ˆ', 'ì”¨ë„', 'ì‰¬ë°œ', 'ì“°ë°œ', 'ì“”ë°œ', 'ìŒ°ë°œ', 'ì’¸ë°œ', 'ì”¨íŒ”', 'ì”¨ë°',
    'ì”¨ë°¯', 'ì‘¤ë°œ', 'ì¹˜ë°œ', 'ë°œì”¨', 'ë¦¬ë°œ', 'ì”¨ë³¼', 'ì°Œë°œ', 'ì”¨ë¹„ë°”ë¼ë„', 'ì‹œë°”ë„',
    'ì”¨ë°”ë¼', 'ì’¸íŒ”', 'ì‰¬íŒ”', 'ì”¨ë°®', 'ì’¸ë°®', 'ì‹œë°®', 'ì”¨ì‚ë¼', 'ì”¨ë²Œ', 'ìŠˆë²Œ', 'ì‹œë¶ˆ',
    'ì‹œë¶€ë ', 'ì”¨ë¶€ë ', 'ì‹œë¶€ë­', 'ì”¨ë¶€ë­', 'ë°œë†ˆì‹œ', 'ë›°ë°œ', 'ë›°ë´˜', 'ëœ¨ë°œ', 'ëœ¨ë²Œ',
    'ë„ë°œ', 'ì”¨ë°”ì•Œ', 'ìƒ¤ë¹¨', 'ìŠ¤ë²Œ', 'ì“°ë²Œ', 'ì‹ ë°œë ¨', 'ì‹ ë°œë…„', 'ì‹ ë°œë†ˆ', 'ë ë°”ë„', 'ì‹œë°©',
    'ì”¨ë°©', 'ì”¨ë¶€ë ¨', 'ì‹œë¶€ë ¨', 'ì”¨ì‡ë°œ', 'ì”¨ì‡íŒŒì•Œ', 'ì”¨ì‡ë°”ì•Œ', 'ì‹œì‡ë°œ', 'ì‹œì‡ë°”ì•Œ', 'ì’¸ì´ë°œ',
    'ì‰¬ì´ë¹¨', 'ì”¹íŒ”', 'ì‰¬ë°”', 'ì‹œë³‘ë°œì‹ ', 'ì”±ë¹©', 'ì‰¬ë°”ë‚œ', 'ì‰¬ë°”ë†ˆ', 'ì‰¬ë°”ë…€', 'ì‰¬ë°”ë…„', 'ì‰¬ë°”ë…¸ë§ˆ', 'ì‰¬ë°”ìƒˆ', 'ì‰¬ë¶ˆ', 'ì‰¬ì´ë°”',
    'ì‹œë²¨ë†ˆ', 'ì‹œë±…ë†ˆ', 'ì‹œë´‰ìƒˆ', 'ì”»ë»˜', 'ì”Œë²Œ',
    'wlfkf', 'gë„', 'gëŸ´', 'gë¡¤', 'gë¢€', 'giral', 'zië„', 'jië„', 'ã…ˆã„¹', 'ì§€ã„¹', 'ã…ˆë„', 'ã…ˆë¼',
    'ì§€ë„', 'ì°Œë„', 'ì§€ëŸ´', 'ì§€ë¡¤', 'ë„ì§€', 'ì¥ë„', 'ì®œë„', 'ì§€ë¢€', 'ë„ë„',
    'ã…„', 'ã…‚ã……', 'ë³‘ã……', 'ã…‚ì‹ ', 'ã…•ã…‡ì‹ ', 'ã…‚ã…‡ì‹ ', 'ë·°ì‹ ', 'ë³‘ì‹ ', 'ë³‘ë”±', 'ë²¼ì‹ ', 'ë¶±ì‹ ',
    'ë¼ì‹ ', 'ë¿½ì‹ ', 'ì‚¥ì‹ ', 'ë³‘ì‹œë‹ˆ', 'ë³‘í˜•ì‹ ', 'ëµ¹ì‹ ', 'ë³‘ê¸´', 'ë¹„ì‘ì‹ ',
    'ì—¼ë³‘', 'ì— ë³‘', 'ì˜˜ë³‘', 'ì–¨ë³‘', 'ì˜˜ë¼',
    'êº¼ì ¸',
    'ì—¿ê°™', 'ì—¿ê°€íŠ¼', 'ì—¿ë¨¹ì–´', 'ë­£ê°™ì€',
    'rotorl', 'rotprl', 'sibìƒˆ', 'ahë¼', 'sã…ë¼', 'xë¼',
    'ã……ã„²', 'ã……ë¼', 'ã…†ë¼', 'ìƒ‰ã„²ã…£', 'ã…†ã…ã„²ã…‘', 'ã…†ã…ã„²ã…£', 'ìƒˆë¼', 'ì‰ë¦¬', 'ìŒ”ë¼', 'ìŒë¼',
    'ì¼ë¼', 'ìŒ¬ë¼', 'ìƒ ë¼', 'ì„¸ë¼', 'ìƒŠ', 'ìŒ–', 'ì„º', 'ì†', 'ì‹­ìƒˆ', 'ìƒˆí‚¤', 'ì”¹ìƒ‰', 'ìƒˆê¹Œ',
    'ìƒˆêº„', 'ìƒ›ë¼', 'ìƒˆë€Œ', 'ìƒˆë ', 'ìƒˆìº¬', 'ìƒ‰êº„', 'ìƒ‰ë¼', 'ì„¹íˆ', 'ì…ê¸°', 'ì…ë¼', 'ì…ê¸°',
    'ì…°ë¼', 'ì…°ë¦¬', 'ì‰êº„', 'ì‹­ìƒ‰êº„', 'ì‹­ë–¼ë¼', 'ì‹­ë°êº„', 'ì‹­ë•Œë¼', 'ì‹­ìƒˆêº„', 'ì‹­ìƒˆìº¬', 'ì‰‘íˆ',
    'ì”¹ìƒˆê¸°', 'ê³ ì•„ìƒˆê¸°', 'ìƒ ê¸°', 'ì• ìƒˆê¸°', 'ì´ìƒˆê¸°', 'ëŠê·¸ìƒˆê¸°', 'ì¥ì• ìƒˆê¸°',
    'wê°™ì€', 'ã…ˆê°™', 'ã…ˆë§', 'ã…ˆê¹Œ', 'ã…ˆê²½', 'ã…ˆê°€íŠ¼', 'ì¢†', 'ì´Ÿ', 'ì¡°ê¹Œ', 'ì¢ˆ', 'ì«’', 'ì¡·',
    'ì¢ƒ', 'ì¤®', 'ì¢‹ê°™', 'ì¢ƒê°™', 'ì¢ƒë¬¼', 'ì¢ƒë°¥', 'ì¤«', 'ì¢‹ë°¥', 'ì¢‹ë¬¼', 'ì¢‡', 'ì¡°ê¹Œì”¹ìŒ”ë¼',
    'ì…', 'ì”¨ì•™', 'ì”¨ì–‘', 'ìƒ¤ì•™', 'ìŒ°ì•™',
    'ë»‘ìœ ', 'ë»í‚¹', 'ë»í', 'ë¹¡í', 'ë¿©í', 'ë»‘í', 'ë¹¡ìœ ', 'ë»’í',
    'ë‹¥ì³', 'ë‹­ì³', 'ë‹¥ì¹˜ë¼', 'ì•„ê°€ë¦¬í•´',
    'dogìƒˆ', 'ê°œã…ìƒ‰',
    'ê°œê°™', 'ê°œê°€íŠ¼', 'ê°œì‰‘', 'ê°œìŠ¤í‚¤', 'ê°œì„¸ë¼', 'ê°œìƒ‰íˆ', 'ê°œê°€ë‡¬', 'ê°œìƒˆê¸°', 'ê°œìŒ”ê¸°', 'ê°œìŒ”ë¼',
    'ìŒ–', 'ì†', 'ìƒˆê¸”', 'ê°œì†Œë¦¬', 'ê°œë…„', 'ê°œë“œë¦½', 'ê°œë¼ì§€', 'ê°œì”¹ì°½', 'ê°œê°„ë‚˜', 'ê°œìŠ¤ë¼', 'ê°œì„¹ê¸°',
    'ê°œìì‹', 'ê°œë•Œêº„', 'ê°œë•Œë¼', 'ê°œë°œë‚¨ì•„', 'ê°œìƒ›ë¼', 'ê°œê°€ë“ ', 'ê°œê°€ëœ¬', 'ê°œê°€í„´', 'ê°œê°€íˆ°',
    'ê°œê°‡ì€', 'ê°œê°ˆë³´', 'ê°œê±¸ë ˆ', 'ê°œë„ˆë§ˆ', 'ê°œë„ˆë¯€', 'ê°œë„Œ', 'ê°œë„˜', 'ê°œë…€ë‚˜',
    'ê°œë…¸ë§ˆ', 'ê°œnoë¬´ìƒˆë¼', 'ê°œë…¼', 'ê°œë†ˆ', 'ê°œë‡¨ë‚˜', 'ê°œë‡¬', 'ê°œë‡¸', 'ê°œë‡½', 'ê°œëˆ”', 'ê°œëŠë§ˆ',
    'ê°œëŠ ', 'ê°œë™ê¸°', 'ê°œë ¨', 'ê°œë°œë‚¨ì•„', 'ê°œë°œë‡¬', 'ê°œìƒ‰', 'ê°œìƒ‰ê¸°',
    'ê°œìƒ‰ë¼', 'ê°œìƒ›í‚¤', 'ê°œìƒ›í‚¹', 'ê°œìƒ›íˆ', 'ê°œìƒœë¼', 'ê°œìƒí‚¤', 'ê°œìƒ ', 'ê°œìƒ¤ë¼', 'ê°œìƒ¤í‚¥',
    'ê°œìƒ¥', 'ê°œìƒ¹ëŠ ', 'ê°œì„¸ë¦¬', 'ê°œì„¸í‚¤', 'ê°œì„¹íˆ', 'ê°œì„º', 'ê°œì…ƒ', 'ê°œì…‹í‚¤', 'ê°œì…',
    'ê°œì…°ë¦¬', 'ê°œì†©', 'ê°œì‡„ë¼', 'ê°œì‡…', 'ê°œì‡…ë¼', 'ê°œì‡…í‚¤', 'ê°œì‡—', 'ê°œì‡ ë¦¬', 'ê°œì‰ë¼', 'ê°œì‰ë¦¬',
    'ê°œì‰í‚¤', 'ê°œì‰‘ê°¸', 'ê°œì‰‘ê¸°', 'ê°œì‰‘êº„', 'ê°œì‰‘ë¼', 'ê°œì‰‘ìº¬', 'ê°œì‰‘í‚¤', 'ê°œì‰‘íˆ',
    'ê°œì‰¢', 'ê°œì‰¨', 'ê°œì‰¬ë¼', 'ê°œì‰¬ë¦¬', 'ê°œì‰½', 'ê°œìŠµ', 'ê°œìŠµì„¸', 'ê°œìŠµìŒ”',
    'ê°œì‹€ê¸°', 'ê°œì‹€ë¼', 'ê°œì‹€ë°¸', 'ê°œì‹€í‚ˆ', 'ê°œì‹€í‚¤', 'ê°œì‹', 'ê°œì‹‘ì°½', 'ê°œì‹˜', 'ê°œì‹œë¼',
    'ê°œì‹œí€´', 'ê°œì‹œí‚¤', 'ê°œì‹ê¸°', 'ê°œì‹ë¼', 'ê°œì‹íˆ', 'ê°œì‹­ìƒˆ', 'ê°œì‹­íŒ”', 'ê°œì‹¯ê¸°', 'ê°œì‹¯ë¼',
    'ê°œì‹¯í‚¤', 'ê°œì‹´', 'ê°œìŒë„˜', 'ê°œìŒë…„', 'ê°œìŒë†ˆ', 'ê°œìŒëˆ”', 'ê°œìŒëŠ ', 'ê°œìŒì—°', 'ê°œìŒì˜',
    'ê°œìŒ”êº„', 'ê°œìŒ•', 'ê°œìŒ•ë¼', 'ê°œìŒ°ê¹¨', 'ê°œì…', 'ê°œì„', 'ê°œì…', 'ê°œì¼í‚¤',
    'ê°œìë¦¬', 'ê°œì’œ', 'ê°œì’', 'ê°œì’¯', 'ê°œì’¸', 'ê°œì’¸ë¹¨ë†ˆ', 'ê°œì’¹ê¸°', 'ê°œì“‰', 'ê°œì”€', 'ê°œì”',
    'ê°œì”Œë¼', 'ê°œì”¨ë¼', 'ê°œì”¨íŒ•', 'ê°œì”¨íŒ”', 'ê°œì¡ê²ƒ', 'ê°œì¡ë…„', 'ê°œì¡ë†ˆ', 'ê°œì¡ë‡¬', 'ê°œì “',
    'ê°œì –', 'ê°œì —', 'ê°œì¡‹', 'ê°œì¡°ë˜', 'ê°œì¡°ì˜·', 'ê°œì¡±', 'ê°œì¢ƒ', 'ê°œì¢†', 'ê°œì¢‡',
    'ê°œì§€ë„', 'ê°œì§€ëŸ´', 'ê°œì°½ë…„', 'ê°œí—ˆëŸ¬', 'ê°œí—ˆë²Œë…„', 'ê°œí˜¸ëŸ¬', 'ê°œí˜¸ë¡œ', 'ê°œí›„ë„', 'ê°œí›„ë ˆ',
    'ê°œí›„ë¡œ', 'ê°œí›„ì¥', 'ê±”ì„€ë¼', 'ê±”ì¡ë„˜', 'ê±”ì¡ë…„', 'ê±”ì¡ë‡¬', 'ê²Œê°€íŠ¼', 'ê²Œê°™ì€', 'ê²Œë„ˆë§ˆ',
    'ê²Œë…„', 'ê²Œë…¸ë§ˆ', 'ê²Œë†ˆ', 'ê²Œë‡¨ë‚˜', 'ê²Œë‡¬', 'ê²Œë‡¸', 'ê²Œë‡½', 'ê²Œëˆ”', 'ê²ŒëŠ ', 'ê²Œë ë°œë„˜',
    'ê²Œë¶€ë„', 'ê²Œë¶€ì•Œ', 'ê²Œìƒˆë¼', 'ê²Œìƒˆë¦¬', 'ê²Œìƒˆí‚¤', 'ê²Œìƒ‰', 'ê²Œìƒ‰ê¸°', 'ê²Œìƒ‰ë¼', 'ê²Œìƒ›í‚¤',
    'ê²Œì„¸êº„', 'ê²Œìì§€', 'ê²Œì¡ë„˜', 'ê²Œì¡ë…„', 'ê²Œì¡ë‡¬', 'ê²Œì “', 'ê²Œì¢†', 'ê³„ê°™ì€ë‡¬', 'ê³„ë‡¬',
    'ê³„ë‡½', 'ì‰¬ëŒ•', 'ì‰¬ë…', 'ê°œìƒë¼'
];


const allProfanityPatterns: string[] = [
    ...GENERAL_PROFANITY_PATTERNS,
];

allProfanityPatterns.sort((a, b) => b.length - a.length);

function escapeRegex(string: string): string {
    return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
}

const singleCharMapRegex: RegExp = new RegExp(Object.keys(SINGLE_CHAR_NORMALIZATION_MAP).map(key => escapeRegex(key)).join('|'), 'gi');

const multiCharReplacementRegex: RegExp = new RegExp(
    Object.keys(MULTI_CHAR_REPLACEMENTS)
        .map(escapeRegex)
        .sort((a, b) => b.length - a.length)
        .join('|'),
    'gi'
);

export function general(text: string | any): boolean {
    if (typeof text !== 'string') {
        if (text === null || text === undefined) {
             throw new Error('korcen: í™•ì¸í•  í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”');
        }
        throw new Error('korcen: String íƒ€ì…ë§Œ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤');
    }
    if (!text.trim()) {
        throw new Error('korcen: í™•ì¸í•  í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”');
    }

    let processedText: string = text.toLowerCase().replace(/ /gi, '');

    processedText = processedText.replace(singleCharMapRegex, (match: string): string => {
        const lowerMatch = match.toLowerCase();
        for (const key in SINGLE_CHAR_NORMALIZATION_MAP) {
            if (key.toLowerCase() === lowerMatch) {
                return SINGLE_CHAR_NORMALIZATION_MAP[key];
            }
        }
        return match;
    });

    processedText = processedText.replace(multiCharReplacementRegex, (match: string): string => {
        const lowerMatch = match.toLowerCase();
        for (const key in MULTI_CHAR_REPLACEMENTS) {
            if (key.toLowerCase() === lowerMatch) {
                return MULTI_CHAR_REPLACEMENTS[key];
            }
        }
        return match;
    });

    processedText = processedText.replace(ALL_FP_REGEX, '');

    for (const pattern of allProfanityPatterns) {
        if (processedText.includes(pattern.toLowerCase())) {
            return true;
        }
    }

    return false;
}